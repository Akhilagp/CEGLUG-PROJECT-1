The gist of the code:
https://gist.github.com/anonymous/64f0b1a7d27c0db4ace2f1a43d48e750
